{"ast":null,"code":"var _jsxFileName = \"/Users/jingkangng/Documents/Y4S1/CG4002/dashboard/client/src/components/mqtt_test/index.js\";\nimport React, { createContext } from \"react\";\nimport Connection from \"./connection\";\nimport Subscriber from \"./subscriber\";\nimport Receiver from \"./receiver\";\nimport mqtt from \"mqtt\";\nimport { List, WhiteSpace } from \"antd-mobile\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Item = List.Item;\nconst Brief = Item.Brief;\nconst num1 = Math.floor(Math.random() * (8 - 1) + 1);\nconst num2 = Math.floor(Math.random() * (3 - 1) + 1);\nexport const QosOption = /*#__PURE__*/createContext([]);\nconst qosOption = [{\n  label: \"0\",\n  value: 0\n}, {\n  label: \"1\",\n  value: 1\n}, {\n  label: \"2\",\n  value: 2\n}];\n\nclass ClassMqtt extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.handleConnect = (host, mqttOptions) => {\n      this.setState({\n        connectStatus: \"Connecting\"\n      });\n      this.client = mqtt.connect(host, mqttOptions);\n\n      if (this.client) {\n        this.client.on(\"connect\", () => {\n          this.setState({\n            connectStatus: \"Connected\"\n          });\n        });\n        this.client.on(\"error\", err => {\n          console.error(\"Connection error: \", err);\n          this.client.end();\n        });\n        this.client.on(\"reconnect\", () => {\n          this.setState({\n            connectStatus: \"Reconnecting\"\n          });\n        });\n        this.client.on(\"message\", (topic, message) => {\n          const payload = {\n            topic,\n            message: message.toString()\n          };\n          const {\n            messages\n          } = this.state;\n\n          if (payload.topic) {\n            const changedMessages = messages.concat([payload]);\n            this.setState({\n              messages: changedMessages\n            });\n          }\n        });\n      }\n    };\n\n    this.handleSubscribe = (topic, qos) => {\n      if (this.client) {\n        this.client.subscribe(topic, {\n          qos\n        }, error => {\n          if (error) {\n            console.log(\"Subscribe to topics error\", error);\n            return;\n          }\n\n          this.setState({\n            isSubed: true\n          });\n        });\n      }\n    };\n\n    this.handleUnsub = topic => {\n      if (this.client) {\n        this.client.unsubscribe(topic, error => {\n          if (error) {\n            console.log(\"Unsubscribe error\", error);\n            return;\n          }\n\n          this.setState({\n            isSubed: false\n          });\n        });\n      }\n    };\n\n    this.handleDisconnect = () => {\n      if (this.client) {\n        this.client.end(() => {\n          this.setState({\n            connectStatus: \"Connect\"\n          });\n          this.setState({\n            client: null\n          });\n        });\n      }\n    };\n\n    this.state = {\n      client: null,\n      connectStatus: \"Connect\",\n      isSubed: false,\n      messages: []\n    };\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        class: \"connect_start\",\n        children: [/*#__PURE__*/_jsxDEV(Connection, {\n          connectBtn: this.state.connectStatus,\n          connect: this.handleConnect,\n          disconnect: this.handleDisconnect\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 104,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(QosOption.Provider, {\n          value: qosOption,\n          children: /*#__PURE__*/_jsxDEV(Subscriber, {\n            showUnsub: this.state.isSubed,\n            subscribe: this.handleSubscribe,\n            unsubscribe: this.handleUnsub\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 110,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 109,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            backgroundColor: 'black',\n            width: '300px',\n            height: '300px',\n            borderRadius: '10px',\n            float: 'left'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: \"user 1\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 120,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              backgroundColor: 'black',\n              width: '10px',\n              height: '10px'\n            },\n            children: \"dance moves: \"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 121,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              backgroundColor: 'black',\n              width: '10px',\n              height: '10px'\n            },\n            children: \"relative position: \"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 123,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            backgroundColor: 'black',\n            width: '300px',\n            height: '300px',\n            borderRadius: '10px',\n            float: 'left'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: \"user 1\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 128,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              backgroundColor: 'black',\n              width: '10px',\n              height: '10px'\n            },\n            children: \"dance moves: \"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 129,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              backgroundColor: 'black',\n              width: '10px',\n              height: '10px'\n            },\n            children: \"relative position: \"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 131,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 127,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            backgroundColor: 'black',\n            width: '300px',\n            height: '300px',\n            borderRadius: '10px',\n            float: 'left'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: \"user 1\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 136,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              backgroundColor: 'black',\n              width: '10px',\n              height: '10px'\n            },\n            children: \"dance moves: \"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 137,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              backgroundColor: 'black',\n              width: '10px',\n              height: '10px'\n            },\n            children: \"relative position: \"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 139,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 135,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginTop: '300px'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            backgroundColor: 'black',\n            width: '200px',\n            height: '100px',\n            borderRadius: '10px',\n            float: 'left'\n          },\n          children: \"sync delay: \"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 145,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            backgroundColor: 'black',\n            width: '200px',\n            height: '100px',\n            borderRadius: '10px',\n            float: 'left'\n          },\n          children: \"EMG: \"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 146,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 144,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nexport default ClassMqtt;","map":{"version":3,"sources":["/Users/jingkangng/Documents/Y4S1/CG4002/dashboard/client/src/components/mqtt_test/index.js"],"names":["React","createContext","Connection","Subscriber","Receiver","mqtt","List","WhiteSpace","Item","Brief","num1","Math","floor","random","num2","QosOption","qosOption","label","value","ClassMqtt","Component","constructor","props","handleConnect","host","mqttOptions","setState","connectStatus","client","connect","on","err","console","error","end","topic","message","payload","toString","messages","state","changedMessages","concat","handleSubscribe","qos","subscribe","log","isSubed","handleUnsub","unsubscribe","handleDisconnect","render","backgroundColor","width","height","borderRadius","float","marginTop"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,aAAhB,QAAqC,OAArC;AACA,OAAOC,UAAP,MAAuB,cAAvB;AACA,OAAOC,UAAP,MAAuB,cAAvB;AACA,OAAOC,QAAP,MAAqB,YAArB;AACA,OAAOC,IAAP,MAAiB,MAAjB;AACA,SAASC,IAAT,EAAeC,UAAf,QAAiC,aAAjC;;AAEA,MAAMC,IAAI,GAAGF,IAAI,CAACE,IAAlB;AACA,MAAMC,KAAK,GAAGD,IAAI,CAACC,KAAnB;AAEA,MAAMC,IAAI,GAAGC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,MAAL,MAAiB,IAAE,CAAnB,IAAwB,CAAnC,CAAb;AACA,MAAMC,IAAI,GAAGH,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,MAAL,MAAiB,IAAE,CAAnB,IAAwB,CAAnC,CAAb;AAEA,OAAO,MAAME,SAAS,gBAAGd,aAAa,CAAC,EAAD,CAA/B;AACP,MAAMe,SAAS,GAAG,CAChB;AACEC,EAAAA,KAAK,EAAE,GADT;AAEEC,EAAAA,KAAK,EAAE;AAFT,CADgB,EAKhB;AACED,EAAAA,KAAK,EAAE,GADT;AAEEC,EAAAA,KAAK,EAAE;AAFT,CALgB,EAShB;AACED,EAAAA,KAAK,EAAE,GADT;AAEEC,EAAAA,KAAK,EAAE;AAFT,CATgB,CAAlB;;AAeA,MAAMC,SAAN,SAAwBnB,KAAK,CAACoB,SAA9B,CAAwC;AACtCC,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACjB,UAAMA,KAAN;;AADiB,SAUnBC,aAVmB,GAUH,CAACC,IAAD,EAAOC,WAAP,KAAuB;AACrC,WAAKC,QAAL,CAAc;AAAEC,QAAAA,aAAa,EAAE;AAAjB,OAAd;AACA,WAAKC,MAAL,GAAcvB,IAAI,CAACwB,OAAL,CAAaL,IAAb,EAAmBC,WAAnB,CAAd;;AAEA,UAAI,KAAKG,MAAT,EAAiB;AACf,aAAKA,MAAL,CAAYE,EAAZ,CAAe,SAAf,EAA0B,MAAM;AAC9B,eAAKJ,QAAL,CAAc;AAAEC,YAAAA,aAAa,EAAE;AAAjB,WAAd;AACD,SAFD;AAGA,aAAKC,MAAL,CAAYE,EAAZ,CAAe,OAAf,EAAyBC,GAAD,IAAS;AAC/BC,UAAAA,OAAO,CAACC,KAAR,CAAc,oBAAd,EAAoCF,GAApC;AACA,eAAKH,MAAL,CAAYM,GAAZ;AACD,SAHD;AAIA,aAAKN,MAAL,CAAYE,EAAZ,CAAe,WAAf,EAA4B,MAAM;AAChC,eAAKJ,QAAL,CAAc;AAAEC,YAAAA,aAAa,EAAE;AAAjB,WAAd;AACD,SAFD;AAGA,aAAKC,MAAL,CAAYE,EAAZ,CAAe,SAAf,EAA0B,CAACK,KAAD,EAAQC,OAAR,KAAoB;AAC5C,gBAAMC,OAAO,GAAG;AAAEF,YAAAA,KAAF;AAASC,YAAAA,OAAO,EAAEA,OAAO,CAACE,QAAR;AAAlB,WAAhB;AACA,gBAAM;AAAEC,YAAAA;AAAF,cAAe,KAAKC,KAA1B;;AACA,cAAIH,OAAO,CAACF,KAAZ,EAAmB;AACjB,kBAAMM,eAAe,GAAGF,QAAQ,CAACG,MAAT,CAAgB,CAACL,OAAD,CAAhB,CAAxB;AACA,iBAAKX,QAAL,CAAc;AAAEa,cAAAA,QAAQ,EAAEE;AAAZ,aAAd;AACD;AACF,SAPD;AAQD;AACF,KAlCkB;;AAAA,SAoCnBE,eApCmB,GAoCD,CAACR,KAAD,EAAQS,GAAR,KAAgB;AAChC,UAAI,KAAKhB,MAAT,EAAiB;AACf,aAAKA,MAAL,CAAYiB,SAAZ,CAAsBV,KAAtB,EAA6B;AAAES,UAAAA;AAAF,SAA7B,EAAuCX,KAAD,IAAW;AAC/C,cAAIA,KAAJ,EAAW;AACTD,YAAAA,OAAO,CAACc,GAAR,CAAY,2BAAZ,EAAyCb,KAAzC;AACA;AACD;;AACD,eAAKP,QAAL,CAAc;AAAEqB,YAAAA,OAAO,EAAE;AAAX,WAAd;AACD,SAND;AAOD;AACF,KA9CkB;;AAAA,SAgDnBC,WAhDmB,GAgDJb,KAAD,IAAW;AACvB,UAAI,KAAKP,MAAT,EAAiB;AACf,aAAKA,MAAL,CAAYqB,WAAZ,CAAwBd,KAAxB,EAAgCF,KAAD,IAAW;AACxC,cAAIA,KAAJ,EAAW;AACTD,YAAAA,OAAO,CAACc,GAAR,CAAY,mBAAZ,EAAiCb,KAAjC;AACA;AACD;;AACD,eAAKP,QAAL,CAAc;AAAEqB,YAAAA,OAAO,EAAE;AAAX,WAAd;AACD,SAND;AAOD;AACF,KA1DkB;;AAAA,SA4DnBG,gBA5DmB,GA4DA,MAAM;AACvB,UAAI,KAAKtB,MAAT,EAAiB;AACf,aAAKA,MAAL,CAAYM,GAAZ,CAAgB,MAAM;AACpB,eAAKR,QAAL,CAAc;AAAEC,YAAAA,aAAa,EAAE;AAAjB,WAAd;AACA,eAAKD,QAAL,CAAc;AAAEE,YAAAA,MAAM,EAAE;AAAV,WAAd;AACD,SAHD;AAID;AACF,KAnEkB;;AAEjB,SAAKY,KAAL,GAAa;AACXZ,MAAAA,MAAM,EAAE,IADG;AAEXD,MAAAA,aAAa,EAAE,SAFJ;AAGXoB,MAAAA,OAAO,EAAE,KAHE;AAIXR,MAAAA,QAAQ,EAAE;AAJC,KAAb;AAMD;;AA6DDY,EAAAA,MAAM,GAAG;AACP,wBACE;AAAA,8BACE;AAAK,QAAA,KAAK,EAAC,eAAX;AAAA,gCACE,QAAC,UAAD;AACE,UAAA,UAAU,EAAE,KAAKX,KAAL,CAAWb,aADzB;AAEE,UAAA,OAAO,EAAE,KAAKJ,aAFhB;AAGE,UAAA,UAAU,EAAE,KAAK2B;AAHnB;AAAA;AAAA;AAAA;AAAA,gBADF,eAME,QAAC,SAAD,CAAW,QAAX;AAAoB,UAAA,KAAK,EAAElC,SAA3B;AAAA,iCACE,QAAC,UAAD;AACE,YAAA,SAAS,EAAE,KAAKwB,KAAL,CAAWO,OADxB;AAEE,YAAA,SAAS,EAAE,KAAKJ,eAFlB;AAGE,YAAA,WAAW,EAAE,KAAKK;AAHpB;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,gBANF;AAAA;AAAA;AAAA;AAAA;AAAA,cADF,eAgBE;AAAA,gCACE;AAAK,UAAA,KAAK,EAAE;AAACI,YAAAA,eAAe,EAAE,OAAlB;AAA2BC,YAAAA,KAAK,EAAE,OAAlC;AAA2CC,YAAAA,MAAM,EAAE,OAAnD;AAA4DC,YAAAA,YAAY,EAAE,MAA1E;AAAkFC,YAAAA,KAAK,EAAE;AAAzF,WAAZ;AAAA,kCACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADF,eAEE;AAAK,YAAA,KAAK,EAAE;AAACJ,cAAAA,eAAe,EAAE,OAAlB;AAA2BC,cAAAA,KAAK,EAAE,MAAlC;AAA0CC,cAAAA,MAAM,EAAE;AAAlD,aAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAFF,eAIE;AAAK,YAAA,KAAK,EAAE;AAACF,cAAAA,eAAe,EAAE,OAAlB;AAA2BC,cAAAA,KAAK,EAAE,MAAlC;AAA0CC,cAAAA,MAAM,EAAE;AAAlD,aAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAJF;AAAA;AAAA;AAAA;AAAA;AAAA,gBADF,eASE;AAAK,UAAA,KAAK,EAAE;AAACF,YAAAA,eAAe,EAAE,OAAlB;AAA2BC,YAAAA,KAAK,EAAE,OAAlC;AAA2CC,YAAAA,MAAM,EAAE,OAAnD;AAA4DC,YAAAA,YAAY,EAAE,MAA1E;AAAkFC,YAAAA,KAAK,EAAE;AAAzF,WAAZ;AAAA,kCACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADF,eAEE;AAAK,YAAA,KAAK,EAAE;AAACJ,cAAAA,eAAe,EAAE,OAAlB;AAA2BC,cAAAA,KAAK,EAAE,MAAlC;AAA0CC,cAAAA,MAAM,EAAE;AAAlD,aAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAFF,eAIE;AAAK,YAAA,KAAK,EAAE;AAACF,cAAAA,eAAe,EAAE,OAAlB;AAA2BC,cAAAA,KAAK,EAAE,MAAlC;AAA0CC,cAAAA,MAAM,EAAE;AAAlD,aAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAJF;AAAA;AAAA;AAAA;AAAA;AAAA,gBATF,eAiBE;AAAK,UAAA,KAAK,EAAE;AAACF,YAAAA,eAAe,EAAE,OAAlB;AAA2BC,YAAAA,KAAK,EAAE,OAAlC;AAA2CC,YAAAA,MAAM,EAAE,OAAnD;AAA4DC,YAAAA,YAAY,EAAE,MAA1E;AAAkFC,YAAAA,KAAK,EAAE;AAAzF,WAAZ;AAAA,kCACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADF,eAEE;AAAK,YAAA,KAAK,EAAE;AAACJ,cAAAA,eAAe,EAAE,OAAlB;AAA2BC,cAAAA,KAAK,EAAE,MAAlC;AAA0CC,cAAAA,MAAM,EAAE;AAAlD,aAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAFF,eAIE;AAAK,YAAA,KAAK,EAAE;AAACF,cAAAA,eAAe,EAAE,OAAlB;AAA2BC,cAAAA,KAAK,EAAE,MAAlC;AAA0CC,cAAAA,MAAM,EAAE;AAAlD,aAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAJF;AAAA;AAAA;AAAA;AAAA;AAAA,gBAjBF;AAAA;AAAA;AAAA;AAAA;AAAA,cAhBF,eA0CE;AAAK,QAAA,KAAK,EAAE;AAACG,UAAAA,SAAS,EAAE;AAAZ,SAAZ;AAAA,gCACE;AAAK,UAAA,KAAK,EAAE;AAACL,YAAAA,eAAe,EAAE,OAAlB;AAA2BC,YAAAA,KAAK,EAAE,OAAlC;AAA2CC,YAAAA,MAAM,EAAE,OAAnD;AAA4DC,YAAAA,YAAY,EAAE,MAA1E;AAAkFC,YAAAA,KAAK,EAAE;AAAzF,WAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBADF,eAEE;AAAK,UAAA,KAAK,EAAE;AAACJ,YAAAA,eAAe,EAAE,OAAlB;AAA2BC,YAAAA,KAAK,EAAE,OAAlC;AAA2CC,YAAAA,MAAM,EAAE,OAAnD;AAA4DC,YAAAA,YAAY,EAAE,MAA1E;AAAkFC,YAAAA,KAAK,EAAE;AAAzF,WAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAFF;AAAA;AAAA;AAAA;AAAA;AAAA,cA1CF;AAAA;AAAA;AAAA;AAAA;AAAA,YADF;AAkDD;;AAzHqC;;AA4HxC,eAAerC,SAAf","sourcesContent":["import React, { createContext } from \"react\";\r\nimport Connection from \"./connection\";\r\nimport Subscriber from \"./subscriber\";\r\nimport Receiver from \"./receiver\";\r\nimport mqtt from \"mqtt\";\r\nimport { List, WhiteSpace } from \"antd-mobile\";\r\n\r\nconst Item = List.Item\r\nconst Brief = Item.Brief\r\n\r\nconst num1 = Math.floor(Math.random() * (8-1) + 1)\r\nconst num2 = Math.floor(Math.random() * (3-1) + 1)\r\n\r\nexport const QosOption = createContext([]);\r\nconst qosOption = [\r\n  {\r\n    label: \"0\",\r\n    value: 0,\r\n  },\r\n  {\r\n    label: \"1\",\r\n    value: 1,\r\n  },\r\n  {\r\n    label: \"2\",\r\n    value: 2,\r\n  },\r\n];\r\n\r\nclass ClassMqtt extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      client: null,\r\n      connectStatus: \"Connect\",\r\n      isSubed: false,\r\n      messages: [],\r\n    };\r\n  }\r\n\r\n  handleConnect = (host, mqttOptions) => {\r\n    this.setState({ connectStatus: \"Connecting\" });\r\n    this.client = mqtt.connect(host, mqttOptions);\r\n\r\n    if (this.client) {\r\n      this.client.on(\"connect\", () => {\r\n        this.setState({ connectStatus: \"Connected\" });\r\n      });\r\n      this.client.on(\"error\", (err) => {\r\n        console.error(\"Connection error: \", err);\r\n        this.client.end();\r\n      });\r\n      this.client.on(\"reconnect\", () => {\r\n        this.setState({ connectStatus: \"Reconnecting\" });\r\n      });\r\n      this.client.on(\"message\", (topic, message) => {\r\n        const payload = { topic, message: message.toString() };\r\n        const { messages } = this.state;\r\n        if (payload.topic) {\r\n          const changedMessages = messages.concat([payload]);\r\n          this.setState({ messages: changedMessages });\r\n        }\r\n      });\r\n    }\r\n  };\r\n\r\n  handleSubscribe = (topic, qos) => {\r\n    if (this.client) {\r\n      this.client.subscribe(topic, { qos }, (error) => {\r\n        if (error) {\r\n          console.log(\"Subscribe to topics error\", error);\r\n          return;\r\n        }\r\n        this.setState({ isSubed: true });\r\n      });\r\n    }\r\n  };\r\n\r\n  handleUnsub = (topic) => {\r\n    if (this.client) {\r\n      this.client.unsubscribe(topic, (error) => {\r\n        if (error) {\r\n          console.log(\"Unsubscribe error\", error);\r\n          return;\r\n        }\r\n        this.setState({ isSubed: false });\r\n      });\r\n    }\r\n  };\r\n\r\n  handleDisconnect = () => {\r\n    if (this.client) {\r\n      this.client.end(() => {\r\n        this.setState({ connectStatus: \"Connect\" });\r\n        this.setState({ client: null });\r\n      });\r\n    }\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <div>\r\n        <div class=\"connect_start\">\r\n          <Connection\r\n            connectBtn={this.state.connectStatus}\r\n            connect={this.handleConnect}\r\n            disconnect={this.handleDisconnect}\r\n          />\r\n          <QosOption.Provider value={qosOption}>\r\n            <Subscriber\r\n              showUnsub={this.state.isSubed}\r\n              subscribe={this.handleSubscribe}\r\n              unsubscribe={this.handleUnsub}\r\n            />\r\n          </QosOption.Provider>\r\n        </div>\r\n          \r\n        <div>\r\n          <div style={{backgroundColor: 'black', width: '300px', height: '300px', borderRadius: '10px', float: 'left'}}>\r\n            <div>user 1</div>\r\n            <div style={{backgroundColor: 'black', width: '10px', height: '10px'}}>dance moves: </div>\r\n            {/* <Receiver messages={this.state.messages}></Receiver> */}\r\n            <div style={{backgroundColor: 'black', width: '10px', height: '10px'}}>relative position: </div>\r\n            {/* <Receiver messages={this.state.messages}></Receiver> */}\r\n          </div>\r\n\r\n          <div style={{backgroundColor: 'black', width: '300px', height: '300px', borderRadius: '10px', float: 'left'}}>\r\n            <div>user 1</div>\r\n            <div style={{backgroundColor: 'black', width: '10px', height: '10px'}}>dance moves: </div>\r\n            {/* <Receiver messages={this.state.messages}></Receiver> */}\r\n            <div style={{backgroundColor: 'black', width: '10px', height: '10px'}}>relative position: </div>\r\n            {/* <Receiver messages={this.state.messages}></Receiver> */}\r\n          </div>\r\n\r\n          <div style={{backgroundColor: 'black', width: '300px', height: '300px', borderRadius: '10px', float: 'left'}}>\r\n            <div>user 1</div>\r\n            <div style={{backgroundColor: 'black', width: '10px', height: '10px'}}>dance moves: </div>\r\n            {/* <Receiver messages={this.state.messages}></Receiver> */}\r\n            <div style={{backgroundColor: 'black', width: '10px', height: '10px'}}>relative position: </div>\r\n            {/* <Receiver messages={this.state.messages}></Receiver> */}\r\n          </div>\r\n        </div>\r\n\r\n        <div style={{marginTop: '300px'}}>\r\n          <div style={{backgroundColor: 'black', width: '200px', height: '100px', borderRadius: '10px', float: 'left'}}>sync delay: </div>\r\n          <div style={{backgroundColor: 'black', width: '200px', height: '100px', borderRadius: '10px', float: 'left'}}>EMG: </div>\r\n        </div>\r\n\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default ClassMqtt;"]},"metadata":{},"sourceType":"module"}