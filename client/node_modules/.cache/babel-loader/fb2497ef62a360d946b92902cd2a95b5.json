{"ast":null,"code":"var _jsxFileName = \"/Users/jingkangng/Documents/Y4S1/CG4002/dashboard/client/src/components/Authorisation/Authorisation.js\";\nimport React, { Component } from 'react';\nimport { Redirect, Route } from 'react-router-dom';\nimport decode from 'jwt-decode';\nimport Login from '../Login/Login';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst Authentication = Page => {\n  return class extends Component {\n    constructor() {\n      super();\n      const token = localStorage.getItem('token');\n      let decodedToken = 0; // console.log(token)\n\n      if (token == 'undefined') {\n        console.log('no token');\n      } else {\n        decodedToken = decode(localStorage.getItem('token'));\n      } // const decodedToken = localStorage.getItem('token')  ? decode(localStorage.getItem('token')) : null\n\n\n      this.state = {\n        authorised: token == 'undefined' ? false : decodedToken.exp * 1000 > new Date().getTime() // authorised: false\n\n      };\n    }\n\n    componentDidMount() {\n      // console.log(localStorage.getItem('token') ? new Date(decode(localStorage.getItem('token')).exp * 1000) : null)\n      console.log(this.state.authorised);\n    }\n\n    componentDidUpdate(prevState) {\n      if (prevState.authorised !== this.state.authorised) {\n        console.log('no longer authorised');\n      }\n    }\n\n    render() {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        children: this.state.authorised ? /*#__PURE__*/_jsxDEV(Page, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 41,\n          columnNumber: 21\n        }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(Route, {\n            path: \"/login\",\n            render: props => /*#__PURE__*/_jsxDEV(Login, { ...props\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 44,\n              columnNumber: 67\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 44,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Redirect, {\n            to: {\n              pathname: \"./login\",\n              state: {\n                authorised: false\n              }\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 45,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 43,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 39,\n        columnNumber: 17\n      }, this);\n    }\n\n  };\n};\n\n_c = Authentication;\nexport default Authentication;\n\nvar _c;\n\n$RefreshReg$(_c, \"Authentication\");","map":{"version":3,"sources":["/Users/jingkangng/Documents/Y4S1/CG4002/dashboard/client/src/components/Authorisation/Authorisation.js"],"names":["React","Component","Redirect","Route","decode","Login","Authentication","Page","constructor","token","localStorage","getItem","decodedToken","console","log","state","authorised","exp","Date","getTime","componentDidMount","componentDidUpdate","prevState","render","props","pathname"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,SAAQC,QAAR,EAAkBC,KAAlB,QAA8B,kBAA9B;AACA,OAAOC,MAAP,MAAmB,YAAnB;AACA,OAAOC,KAAP,MAAkB,gBAAlB;;;AAGA,MAAMC,cAAc,GAAIC,IAAD,IAAU;AAC7B,SAAO,cAAcN,SAAd,CAAuB;AAC1BO,IAAAA,WAAW,GAAE;AACT;AAEA,YAAMC,KAAK,GAAGC,YAAY,CAACC,OAAb,CAAqB,OAArB,CAAd;AACA,UAAIC,YAAY,GAAG,CAAnB,CAJS,CAKT;;AACA,UAAIH,KAAK,IAAI,WAAb,EAAyB;AACrBI,QAAAA,OAAO,CAACC,GAAR,CAAY,UAAZ;AACH,OAFD,MAEK;AACDF,QAAAA,YAAY,GAAGR,MAAM,CAACM,YAAY,CAACC,OAAb,CAAqB,OAArB,CAAD,CAArB;AACH,OAVQ,CAYT;;;AAEA,WAAKI,KAAL,GAAa;AACTC,QAAAA,UAAU,EAAEP,KAAK,IAAI,WAAT,GAAuB,KAAvB,GAAgCG,YAAY,CAACK,GAAb,GAAmB,IAAnB,GAA0B,IAAIC,IAAJ,GAAWC,OAAX,EAD7D,CAET;;AAFS,OAAb;AAIH;;AACDC,IAAAA,iBAAiB,GAAE;AACf;AACAP,MAAAA,OAAO,CAACC,GAAR,CAAY,KAAKC,KAAL,CAAWC,UAAvB;AACH;;AACDK,IAAAA,kBAAkB,CAACC,SAAD,EAAW;AACzB,UAAGA,SAAS,CAACN,UAAV,KAAyB,KAAKD,KAAL,CAAWC,UAAvC,EAAkD;AAC9CH,QAAAA,OAAO,CAACC,GAAR,CAAY,sBAAZ;AACH;AACJ;;AACDS,IAAAA,MAAM,GAAE;AACJ,0BACI;AAAA,kBACK,KAAKR,KAAL,CAAWC,UAAX,gBACD,QAAC,IAAD;AAAA;AAAA;AAAA;AAAA,gBADC,gBAGD;AAAA,kCACI,QAAC,KAAD;AAAO,YAAA,IAAI,EAAC,QAAZ;AAAqB,YAAA,MAAM,EAAKQ,KAAD,iBAAW,QAAC,KAAD,OAAWA;AAAX;AAAA;AAAA;AAAA;AAAA;AAA1C;AAAA;AAAA;AAAA;AAAA,kBADJ,eAEI,QAAC,QAAD;AAAU,YAAA,EAAE,EAAE;AACVC,cAAAA,QAAQ,EAAC,SADC;AAEVV,cAAAA,KAAK,EAAC;AAAEC,gBAAAA,UAAU,EAAE;AAAd;AAFI;AAAd;AAAA;AAAA;AAAA;AAAA,kBAFJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAJJ;AAAA;AAAA;AAAA;AAAA,cADJ;AAcH;;AA5CyB,GAA9B;AA8CH,CA/CD;;KAAMV,c;AAiDN,eAAeA,cAAf","sourcesContent":["import React, { Component } from 'react';\nimport {Redirect, Route} from 'react-router-dom'\nimport decode from 'jwt-decode';\nimport Login from '../Login/Login'\n\n\nconst Authentication = (Page) => {\n    return class extends Component{\n        constructor(){\n            super();\n\n            const token = localStorage.getItem('token')\n            let decodedToken = 0\n            // console.log(token)\n            if (token == 'undefined'){\n                console.log('no token')\n            }else{\n                decodedToken = decode(localStorage.getItem('token'))\n            }\n\n            // const decodedToken = localStorage.getItem('token')  ? decode(localStorage.getItem('token')) : null\n\n            this.state = {\n                authorised: token == 'undefined' ? false : (decodedToken.exp * 1000 > new Date().getTime())\n                // authorised: false\n            };\n        }\n        componentDidMount(){\n            // console.log(localStorage.getItem('token') ? new Date(decode(localStorage.getItem('token')).exp * 1000) : null)\n            console.log(this.state.authorised)\n        }\n        componentDidUpdate(prevState){\n            if(prevState.authorised !== this.state.authorised){\n                console.log('no longer authorised')\n            }\n        }\n        render(){\n            return(\n                <div>\n                    {this.state.authorised ? \n                    <Page /> \n                    : \n                    <div> \n                        <Route path=\"/login\" render = {(props) => <Login {...props} />} />\n                        <Redirect to={{\n                            pathname:\"./login\",\n                            state:{ authorised: false }\n                        }} /> \n                    </div>}\n                </div>\n            )\n        }\n    };\n}\n \nexport default Authentication;\n"]},"metadata":{},"sourceType":"module"}